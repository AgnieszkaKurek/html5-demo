<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>notitle</title>
    <link rel="stylesheet" href="style.css" type="text/css" />
    <script src="Script1.js"></script>
</head>
<body>
    <article>
        <h1>Forms<span> - validation messages</span></h1>
    </article>
    <div id="result-stub" class="well hidden">
        <form id="change-email-form" name="change-email-form">
            <h4>Change Email Address</h4>
            <label>Username:</label>
            <input type="text"
                   id="username" name="username"
                   pattern="[a-zA-Z]{5,}"
                   placeholder="Username"
                   maxlength="30" required />
            <div class="validation-massages">
                <span data-rule="valueMising"
                      class="hide">The username is required.</span>
                <span data-rule="patternMismatch"
                      class="hide">Must be a series of alpha character only(min 5, max 30).</span>
            </div>
            <label>Email:</label>
            <input type="email" id="email" name="email"
                   title="Email required" required />
            <div class="validation-massages">
                <span data-rule="valueMising" class="hide">
                    An email address is required
                </span>
                <span data-rule="typeMismatch">Special character are not allowed</span>
            </div>


            <hr />

            <button type="submit" id="submit"
                    name="submit" class="btn">
                Change
            </button>

            <button type="button" id="checkValidation"
                    name="checkValidation"
                    class="btn">
                Validate
            </button>
            </fieldset>
        </form>
    </div>

    <script data-step="1" data-label="Custom Error Messages">
            var step1 = function() {
                //---
                // Create a container for validation rule names.
                var ruleNames = [];

                // Fills array with rule names.
                // Looks for all elements with 'vmsg' class
                // and then adds the first class (rule
                // name) to the array.
                $("[data-rule]").each(function(i, element) {
                  var ruleName = element.getAttribute('data-rule');
                  if ($.inArray(ruleName, ruleNames) < 0) {
                      ruleNames.push(ruleName);
                  }
                });

                var
                    // First clear the UI by hiding all validation
                    // messages. Then run validation rules on the
                    // selected form.
                    validate = function() {
                      $(".validation-messages span")
                          .addClass('hide');

                      document.getElementById('change-email-form')
                          .checkValidity();
                    },

                    // Check each input element to determine which
                    // element is invalid. Once an invalid state
                    // is detected, then loop through the
                    // validation rules to find out which is
                    // broken and therefore which message to
                    // display to the user.
                    validationFail = function(e) {
                        var
                            element = e.srcElement,
                            validity = element.validity;

                        if (!validity.valid) {
                            ruleNames.forEach(function(ruleName) {

                                checkRule(validity,
                                          ruleName,
                                          element);
                            });

                            e.preventDefault();
                        }
                    },

                    // Uses the instance of the input element's
                    // ValidityState object to run a validation
                    // rule. If the validation rule returns
                    // 'true' then the rule is broken and
                    // the appropriate validation message is
                    // exposed to the user.
                    checkRule = function(state, ruleName, ele) {
                        if (state[ruleName]) {
                            $(ele).next()
                                .find('[data-rule="'
                                    + ruleName + '"]')
                                .removeClass('hide');
                        }
                    };

                // Attaches validation event handlers to all input
                // elements that are NOT buttons.
                $(':input:not(:button)').each(function() {
                    this.oninvalid = validationFail;
                    this.onblur = validate;
                });

                $('#checkValidation').click(validate);
                //---
            }
    </script>
    <script data-label="Command Object Mapping">
            var _commands = {
                executeOnLoad: true,
                hideCommandButtons: true,
                currentStep: 0,
                step1: step1
            };
    </script>
    <script data-main="../js/main" src="../js/require-jquery.js"></script>

    <h4>Video</h4>
    <video width="320">
        <source src="big_buck_bunny.mp4" /><!--Serve first for iPad-->
        <source src="big_buck_bunny.ogv" />
        <source src="big_buck_bunny.webm" />
    </video>
</body>
</html> 